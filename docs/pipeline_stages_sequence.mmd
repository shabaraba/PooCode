sequenceDiagram
    %% ã‚·ãƒ¼ã‚±ãƒ³ã‚¹å›³ã®ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ‘ãƒ³ãƒˆå®šç¾©
    participant Runtime as å®Ÿè¡Œãƒ©ãƒ³ã‚¿ã‚¤ãƒ 
    participant Evaluator as è©•ä¾¡å™¨
    participant Env as ç’°å¢ƒ
    participant Stage1 as ã‚¹ãƒ†ãƒ¼ã‚¸1
    participant Stage2 as ã‚¹ãƒ†ãƒ¼ã‚¸2
    participant Stage3 as ã‚¹ãƒ†ãƒ¼ã‚¸3

    %% ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³è©•ä¾¡é–‹å§‹
    Note over Runtime: ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³è©•ä¾¡é–‹å§‹<br>(ä¾‹: data |> stage1 |> stage2 |> stage3)
    Runtime->>Evaluator: ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³è©•ä¾¡ãƒªã‚¯ã‚¨ã‚¹ãƒˆ
    
    %% ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã®åŸºæœ¬æ§‹é€ è§£æ
    Evaluator->>Evaluator: evalPipeStatement()
    Note over Evaluator: ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã®å…¨ä½“æ§‹é€ ã‚’æŠŠæ¡
    
    %% æœ€åˆã®ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹è©•ä¾¡
    Evaluator->>Evaluator: æœ€åˆã®ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ã‚’è©•ä¾¡
    Evaluator-->>Evaluator: åˆæœŸãƒ‡ãƒ¼ã‚¿
    
    %% ã‚¹ãƒ†ãƒ¼ã‚¸1ã®å‡¦ç†
    Evaluator->>Stage1: ã‚¹ãƒ†ãƒ¼ã‚¸1ã«åˆæœŸãƒ‡ãƒ¼ã‚¿ã‚’æ¸¡ã™
    
    %% ã‚¹ãƒ†ãƒ¼ã‚¸1ã®è©•ä¾¡ç’°å¢ƒæº–å‚™
    Evaluator->>Env: æ–°ã—ã„ã‚¹ãƒ†ãƒ¼ã‚¸ç’°å¢ƒä½œæˆ
    Env-->>Evaluator: ã‚¹ãƒ†ãƒ¼ã‚¸1ã®ç’°å¢ƒ
    
    %% ã‚¹ãƒ†ãƒ¼ã‚¸1ã®å…¥åŠ›è¨­å®š
    Evaluator->>Env: ğŸ•ã«åˆæœŸãƒ‡ãƒ¼ã‚¿ã‚’è¨­å®š
    Note over Env: ç’°å¢ƒå†…: ğŸ• = åˆæœŸãƒ‡ãƒ¼ã‚¿
    
    %% ã‚¹ãƒ†ãƒ¼ã‚¸1ã®è©•ä¾¡
    Evaluator->>Stage1: é–¢æ•°ã¾ãŸã¯ã‚¹ãƒ†ãƒ¼ã‚¸å‡¦ç†å®Ÿè¡Œ
    Stage1->>Env: ğŸ’©ã«çµæœã‚’æ ¼ç´
    Env-->>Stage1: æ ¼ç´å®Œäº†
    Stage1-->>Evaluator: ã‚¹ãƒ†ãƒ¼ã‚¸1ã®çµæœ
    
    %% ã‚¹ãƒ†ãƒ¼ã‚¸2ã®å‡¦ç†
    Evaluator->>Stage2: ã‚¹ãƒ†ãƒ¼ã‚¸2ã«ã‚¹ãƒ†ãƒ¼ã‚¸1ã®çµæœã‚’æ¸¡ã™
    
    %% ã‚¹ãƒ†ãƒ¼ã‚¸2ã®è©•ä¾¡ç’°å¢ƒæº–å‚™
    Evaluator->>Env: æ–°ã—ã„ã‚¹ãƒ†ãƒ¼ã‚¸ç’°å¢ƒä½œæˆ
    Env-->>Evaluator: ã‚¹ãƒ†ãƒ¼ã‚¸2ã®ç’°å¢ƒ
    
    %% ã‚¹ãƒ†ãƒ¼ã‚¸2ã®å…¥åŠ›è¨­å®š
    Evaluator->>Env: ğŸ•ã«ã‚¹ãƒ†ãƒ¼ã‚¸1ã®çµæœã‚’è¨­å®š
    Note over Env: ç’°å¢ƒå†…: ğŸ• = ã‚¹ãƒ†ãƒ¼ã‚¸1ã®çµæœ
    
    %% ã‚¹ãƒ†ãƒ¼ã‚¸2ã®è©•ä¾¡
    Evaluator->>Stage2: é–¢æ•°ã¾ãŸã¯ã‚¹ãƒ†ãƒ¼ã‚¸å‡¦ç†å®Ÿè¡Œ
    Stage2->>Env: ğŸ’©ã«çµæœã‚’æ ¼ç´
    Env-->>Stage2: æ ¼ç´å®Œäº†
    Stage2-->>Evaluator: ã‚¹ãƒ†ãƒ¼ã‚¸2ã®çµæœ
    
    %% ã‚¹ãƒ†ãƒ¼ã‚¸3ã®å‡¦ç†
    Evaluator->>Stage3: ã‚¹ãƒ†ãƒ¼ã‚¸3ã«ã‚¹ãƒ†ãƒ¼ã‚¸2ã®çµæœã‚’æ¸¡ã™
    
    %% ã‚¹ãƒ†ãƒ¼ã‚¸3ã®è©•ä¾¡ç’°å¢ƒæº–å‚™
    Evaluator->>Env: æ–°ã—ã„ã‚¹ãƒ†ãƒ¼ã‚¸ç’°å¢ƒä½œæˆ
    Env-->>Evaluator: ã‚¹ãƒ†ãƒ¼ã‚¸3ã®ç’°å¢ƒ
    
    %% ã‚¹ãƒ†ãƒ¼ã‚¸3ã®å…¥åŠ›è¨­å®š
    Evaluator->>Env: ğŸ•ã«ã‚¹ãƒ†ãƒ¼ã‚¸2ã®çµæœã‚’è¨­å®š
    Note over Env: ç’°å¢ƒå†…: ğŸ• = ã‚¹ãƒ†ãƒ¼ã‚¸2ã®çµæœ
    
    %% ã‚¹ãƒ†ãƒ¼ã‚¸3ã®è©•ä¾¡
    Evaluator->>Stage3: é–¢æ•°ã¾ãŸã¯ã‚¹ãƒ†ãƒ¼ã‚¸å‡¦ç†å®Ÿè¡Œ
    Stage3->>Env: ğŸ’©ã«çµæœã‚’æ ¼ç´
    Env-->>Stage3: æ ¼ç´å®Œäº†
    Stage3-->>Evaluator: ã‚¹ãƒ†ãƒ¼ã‚¸3ã®çµæœ
    
    %% æœ€çµ‚çµæœã®è¿”å´
    Evaluator-->>Runtime: ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³å…¨ä½“ã®çµæœ
    
    %% ç‰¹æ®Šãªãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³æ“ä½œã®èª¬æ˜æ³¨é‡ˆ
    Note over Runtime, Stage3: ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ç‰¹æ®Šã‚ªãƒšãƒ¬ãƒ¼ã‚¿ãƒ¼<br>- é€šå¸¸ã®ãƒ‘ã‚¤ãƒ—: |><br>- ä¸¦åˆ—ãƒ‘ã‚¤ãƒ—: |<br>- ãƒãƒƒãƒ—ãƒ‘ã‚¤ãƒ—: map/<br>- ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ãƒ‘ã‚¤ãƒ—: filter/