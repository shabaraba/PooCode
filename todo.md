# uncode 実装 TODO リスト

## 言語設計
- [x] 仕様書の読み込みと分析
- [x] 言語構造の設計
  - [x] 型システムの詳細化
  - [x] エラーハンドリングの仕組み設計
  - [x] スコープ管理の設計
  - [x] メモリ管理の設計
- [x] 言語機能の設計
  - [x] 標準ライブラリの設計
  - [x] 入出力機能の設計
  - [x] 不足している仕様の補完
- [x] 配列の設計
  - [x] 作成方法
    - [x] [1..10]みたいな作成方法
  - [x] 高階関数の設計
    - [x] map
    - [x] filter
- [ ] 構造体の設計
  - [ ] フィールド定義
  - [ ] メソッド定義
  - [ ] 継承/合成の仕組み検討
- [ ] 引数の型指定の設計
- [ ] 関数の型指定の仕様修正
- [ ] ユニットテストでエラーとなっている箇所の精査

## 実装
- [x] レキサー（字句解析器）の実装
- [x] パーサー（構文解析器）の実装
- [x] AST（抽象構文木）の設計と実装
- [x] インタプリタの実装
  - [x] 評価器の実装
  - [x] 環境（変数スコープ）の実装
  - [x] 組み込み関数の実装
- [x] 配列機能の実装
  - [x] 範囲式 [start..end] の構文解析と評価
  - [x] 配列スライス構文の実装（[start..end], [..end], [start..] など）
  - [x] map, filter 高階関数の実装
  - [x] 負のインデックスのサポート
  - [x] mapを+>パイプ、filterを?>パイプとして実装する


## 不具合修正
- [x] evaluatorやfunctionのデバッグが--debugオプションつけても表示されない
  - [x] 特定フラグの処理確認(show-eval, show-builtin)
  - [x] logger.EvalDebug/logger.Debug呼び出し箇所の確認
  - [x] 条件付きデバッグ出力の実装
- [x] パイプ後の関数の引数に値がうまく渡らない
  - [x] パイプライン評価時の引数処理確認
  - [x] 引数の受け渡しデバッグログ追加
  - [x] パイプライン演算子の再実装検討
- [x] 配列操作の実装および修正
  - [x] インデックスアクセスのエラー処理強化
  - [x] 範囲外アクセスのチェック機能追加
  - [x] 配列操作の例外処理改善
- [x] 関数適用の問題修正
  - [x] ユーザー定義関数が map に渡せるように修正
  - [x] 関数定義と関数呼び出しの順序問題の修正
  - [x] BlockStatement の実装
  - [x] カスタム関数の返り値が正しく取得できない問題の修正
  - [x] エスケープシーケンス処理の修正
- [x] 🍕変数のスコープ問題修正
  - [x] 🍕変数を関数の構造体に直接組み込む設計
  - [x] 関数呼び出し時の🍕変数のスコープ独立化
  - [x] 関数終了時の🍕変数の影響遮断
  - [x] パイプライン処理における🍕変数の適切な管理
  - [x] 既存のグローバル環境に依存した🍕変数の参照部分の修正
- [ ] 条件付き関数の評価問題修正(examples/test.pooが参考になる)
  - [ ] 条件式内での🍕変数参照が常にtrueと評価される問題の分析
  - [ ] 条件式評価時の🍕値参照メカニズムの改善
  - [ ] 条件式評価のタイミング修正（関数呼び出し前→呼び出し時）
  - [ ] 関数選択アルゴリズムでの🍕値の正確な伝播確保
  - [ ] 関数呼び出し時の引数（パラメータ）と🍕値の明確な区別

## リファクタリング
- [ ] 不要なテストファイルやshの削除
- [ ] コードのドキュメント化（コメントの追加）
  - [ ] AST関連のコメント追加
  - [ ] 評価器のコメント追加
  - [ ] 組み込み関数のコメント追加
- [ ] テストカバレッジの向上
  - [ ] ユニットテスト追加
  - [ ] エッジケーステスト追加
- [ ] パフォーマンス最適化
  - [ ] メモリ使用量分析
  - [ ] 処理速度分析
  - [ ] ボトルネック特定と最適化

## テスト
- [ ] ユニットテストの作成
  - [x] レキサーのテスト
  - [x] パーサーのテスト
    - [x] リテラル式（整数、文字列、真偽値、配列、特殊リテラル）
    - [x] 関数リテラルと関数呼び出し
    - [x] 中置・前置演算子
    - [x] プロパティアクセスとインデックスアクセス
    - [x] パイプライン式
    - [x] 代入文とグローバル宣言
    - [ ] エラーケースの検証強化
  - [x] 評価器のテスト
    - [x] 基本式の評価（整数、真偽値、文字列）
    - [x] 中置・前置演算子の評価
    - [x] 条件式と制御構造
    - [x] 関数とパイプライン
    - [x] 配列とインデックスアクセス
    - [x] 組み込み関数
  - [x] 配列機能のテスト
    - [x] 範囲式のテスト
    - [x] 配列スライスのテスト
    - [x] 配列高階関数のテスト
    - [x] インデックスエラーのテスト
  - [x] 組み込み関数のテスト
  - [ ] ユーザー定義関数のテスト
    - [ ] 高階関数としての利用テスト
    - [ ] 関数の返り値処理のテスト
- [x] サンプルプログラムの作成と実行
- [ ] サンプルプログラムの整理
  - [ ] カテゴリ別の整理
  - [ ] テストケースの網羅性向上
- [x] インタプリタのビルドとテスト
- [ ] エラーケースのテスト
  - [x] 基本エラーハンドリングのテスト追加
  - [ ] 構文エラーのテスト強化
  - [x] 型エラーのテストケース追加
  - [x] 関数呼び出しエラーのテストケース追加
  - [x] 配列インデックスエラーのテスト実装
  - [ ] ゼロ除算エラーのテスト実装
  - [ ] プロパティアクセスエラーのテスト実装
  - [ ] パイプラインエラーのテスト実装
  - [ ] その他の実行時エラーのテスト
- [x] 🍕変数のスコープテスト
  - [x] ネストした関数呼び出しでの🍕変数の分離確認
  - [x] パイプライン処理での🍕変数の独立性テスト
  - [x] 複数関数間での🍕変数の干渉がないことの確認
- [ ] 条件付き関数のテスト強化
  - [ ] 条件式 `if 🍕 == X` での正確な分岐テスト
  - [ ] 複数条件付き関数の優先順位テスト
  - [ ] パイプライン内での条件付き関数選択テスト
  - [ ] 条件式内での🍕変数と関数パラメータの区別テスト
  - [ ] 関数内での直接🍕参照とadd関数などの組み込み関数連携テスト

## ドキュメント
- [x] 言語仕様書の作成
- [x] 使い方マニュアルの作成
- [x] サンプルプログラムの解説
- [ ] 使い方ガイドの作成
  - [ ] 初心者向けチュートリアル
  - [ ] コーディング規約
  - [ ] ベストプラクティス
- [ ] サンプルプログラム集の作成
  - [ ] 実用的なプログラム例
  - [ ] アルゴリズム実装例
  - [ ] パターン別サンプル

## パッケージング
- [ ] ビルドスクリプトの作成
  - [ ] 複数OS対応（Linux, macOS, Windows）
  - [ ] デバッグオプションの改善
- [ ] リリースパッケージの作成
  - [ ] バイナリ配布パッケージ
  - [ ] ドキュメント同梱
  - [ ] バージョン管理

## デバッグ機能改善
- [x] ログレベル制御の強化
  - [x] コンポーネント別ログレベル設定
  - [x] 実行時ログレベル切替
  - [x] ログシステムのユニットテスト追加
- [ ] デバッグ表示のカスタマイズ
  - [ ] 詳細度の設定機能
  - [ ] 特定機能のみデバッグ出力
- [ ] エラーメッセージの改善
  - [ ] より詳細なエラー情報
  - [ ] 行番号・位置情報の正確化
  - [ ] ユーザーフレンドリーなエラーメッセージの提供

## エラー処理の強化
- [ ] エラーメッセージの多言語対応
- [ ] エラーコードシステムの導入
- [ ] エラー処理の統一
  - [ ] パーサーエラー
  - [ ] 実行時エラー
  - [ ] 型エラー
- [ ] スタックトレースの実装
- [ ] エラーハンドリングのユーティリティ関数追加
